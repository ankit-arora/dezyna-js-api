if(typeof jQuery==="undefined"||jQuery.fn.jquery!="1.7.1"){var script=document.createElement("script");script.type="text/javascript";script.async=true;script.src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js";var s=document.getElementById("dezynaScript");s.parentNode.insertBefore(script,s)}function isArray(obj){return Object.prototype.toString.call(obj)==="[object Array]"}var QueryString=function(){var query_string={};var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(typeof query_string[pair[0]]==="undefined"){query_string[pair[0]]=pair[1]}else{if(typeof query_string[pair[0]]==="string"){var arr=[query_string[pair[0]],pair[1]];query_string[pair[0]]=arr}else{query_string[pair[0]].push(pair[1])}}}return query_string}();if(typeof QueryString.dezyna_visit_code!=="undefined"&&!isArray(QueryString.dezyna_visit_code)){localStorage.dezyna_visit_code=QueryString.dezyna_visit_code}var DezynaApi=function(){var baseProtocol="https:"==document.location.protocol?"https://":"http://";var baseUrl=baseProtocol+"www.dezyna.com/api/v1";var key="";var landingUrl="";var imageUrl="";var description="";var header="";var host=window.location.hostname;var setKey=function(_key){if(!key){key=_key}};var createPurchase=function(_purchaseObj){if(!key){throw"API key not provided"}if(localStorage.dezyna_visit_code==null){}else{_purchaseObj.purchaseString=_purchaseObj.purchaseString||"";$.ajax({type:"POST",url:baseUrl+"purchases.json",data:{code:localStorage.dezyna_visit_code,amount:_purchaseObj.amount,purchase_string:_purchaseObj.purchaseString},success:function(result){if(result.errorExists==false){localStorage.removeItem("dezyna_visit_code")}else{var test=result;if(localStorage.getItem("dezyna_visit_code")!==null){localStorage.removeItem("dezyna_visit_code")}}},statusCode:{400:function(jqXHR,textStatus,errorThrown){responseObj=JSON&&JSON.parse(jqXHR.responseText)||$.parseJSON(jqXHR.responseText);alert(responseObj.errorInfo)},401:function(jqXHR,textStatus,errorThrown){alert("Authentication Failure.")}},beforeSend:function(xhrObj){xhrObj.setRequestHeader("Authorization",key+":"+host)}})}};var processq=function(){if(_daq.length>0&&typeof jQuery!=="undefined"&&jQuery.fn.jquery=="1.7.1"){var _daqEntry=_daq.shift();switch(_daqEntry[0]){case"_setKey":setKey(_daqEntry[1]);break;case"_createPurchase":createPurchase(_daqEntry[1]);break;default:throw"Error"}}setTimeout(processq,500)};return{process:function(){processq()}}}();DezynaApi.process();